<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedicoDose - Dosage Calculator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Font */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f6f8;
        }
        .tab-button.active {
            border-bottom: 3px solid #06B6D4; /* Cyan 500 */
            color: #06B6D4;
            font-weight: 600;
        }
        .input-group {
            margin-bottom: 1rem;
        }
        .card {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="min-h-screen p-4 sm:p-6 flex justify-center items-start">

    <div id="app" class="w-full max-w-xl bg-white rounded-xl card shadow-xl overflow-hidden">
        
        <!-- Header -->
        <header class="bg-cyan-600 p-6 text-white">
            <h1 class="text-3xl font-bold tracking-wider">MedicoDose</h1>
            <p class="text-sm opacity-90 mt-1">Clinical Dosage Calculator</p>
        </header>

        <!-- Tab Navigation -->
        <div class="flex border-b border-gray-200 bg-gray-50">
            <button id="tab-pediatric" onclick="showTab('pediatric')" class="tab-button active flex-1 py-3 text-center text-gray-700 hover:bg-gray-100 transition duration-150">
                Pediatric
            </button>
            <button id="tab-adult" onclick="showTab('adult')" class="tab-button flex-1 py-3 text-center text-gray-700 hover:bg-gray-100 transition duration-150">
                Adult
            </button>
        </div>

        <!-- Tab Content Container -->
        <main class="p-6">
            
            <!-- Pediatric Calculator Tab -->
            <div id="content-pediatric" class="tab-content">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Pediatric Dosing</h2>
                
                <!-- Section 1: Weight-Based Dosing (Standard mg/kg to mL) -->
                <section class="bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200">
                    <h3 class="font-bold text-lg mb-3 text-cyan-700">1. Standard Weight-Based Dosing (mg/kg)</h3>

                    <!-- Weight Input -->
                    <div class="input-group">
                        <label for="p-weight" class="block text-sm font-medium text-gray-700">Child's Weight</label>
                        <div class="mt-1 flex rounded-md shadow-sm">
                            <input type="number" id="p-weight" min="0.1" step="0.1" placeholder="e.g., 15" class="focus:ring-cyan-500 focus:border-cyan-500 flex-1 block w-full rounded-l-md border-gray-300 p-2.5">
                            <select id="p-weight-unit" onchange="calculatePediatric()" class="rounded-r-md border border-l-0 border-gray-300 bg-white py-2.5 pl-3 pr-1 text-sm font-medium">
                                <option value="kg">kg</option>
                                <option value="lbs">lbs</option>
                            </select>
                        </div>
                    </div>

                    <!-- Dosage Input (mg/kg) -->
                    <div class="input-group">
                        <label for="p-dosage-mgkg" class="block text-sm font-medium text-gray-700">Prescribed Dosage (mg/kg/dose)</label>
                        <input type="number" id="p-dosage-mgkg" min="0.1" step="0.1" placeholder="e.g., 15" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-cyan-500 focus:border-cyan-500 p-2.5">
                    </div>
                    
                    <!-- Concentration Input (mg/mL) -->
                    <div class="input-group">
                        <label for="p-concentration" class="block text-sm font-medium text-gray-700">Stock Concentration (mg/mL)</label>
                        <input type="number" id="p-concentration" min="0.1" step="0.1" placeholder="e.g., 250" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-cyan-500 focus:border-cyan-500 p-2.5">
                    </div>

                    <button onclick="calculatePediatric()" class="w-full bg-cyan-600 text-white py-2 rounded-md hover:bg-cyan-700 transition duration-200 font-semibold mt-2">
                        Calculate Dose
                    </button>
                </section>

                <!-- Pediatric Results Section -->
                <div id="p-results" class="space-y-3 bg-cyan-50 p-4 rounded-xl hidden border-2 border-cyan-300">
                    <h3 class="text-xl font-bold text-cyan-800">Results</h3>
                    <div class="flex justify-between items-center py-2 border-b border-cyan-200">
                        <span class="text-sm font-medium text-gray-600">Calculated Weight (kg):</span>
                        <span id="p-output-weight" class="text-lg font-bold text-gray-900">0 kg</span>
                    </div>
                    <div class="flex justify-between items-center py-2 border-b border-cyan-200">
                        <span class="text-sm font-medium text-gray-600">Total Dose Needed:</span>
                        <span id="p-output-dose" class="text-lg font-bold text-gray-900">0 mg</span>
                    </div>
                    <div class="flex justify-between items-center py-2">
                        <span class="text-sm font-medium text-gray-600">Volume to Administer:</span>
                        <span id="p-output-volume" class="text-2xl font-extrabold text-cyan-600">0 mL</span>
                    </div>
                </div>

                 <!-- Section 2: Clark's Rule (Approximation) -->
                 <section class="bg-yellow-50 p-4 rounded-lg mt-6 border border-yellow-200">
                    <h3 class="font-bold text-sm mb-3 text-yellow-800">2. Clark's Rule (Adult Dose Approximation)</h3>
                    <p class="text-xs text-yellow-700 mb-3">Pediatric Dose (mg) = [Weight (lbs) / 150 lbs] x Adult Dose (mg)</p>
                    
                    <div class="input-group flex space-x-3">
                        <div class="w-1/2">
                            <label for="p-clark-weight-lbs" class="block text-sm font-medium text-gray-700">Weight (lbs)</label>
                            <input type="number" id="p-clark-weight-lbs" min="1" step="1" placeholder="e.g., 45" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-yellow-500 focus:border-yellow-500 p-2.5">
                        </div>
                        <div class="w-1/2">
                            <label for="p-clark-adult-dose" class="block text-sm font-medium text-gray-700">Adult Dose (mg)</label>
                            <input type="number" id="p-clark-adult-dose" min="1" step="1" placeholder="e.g., 500" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-yellow-500 focus:border-yellow-500 p-2.5">
                        </div>
                    </div>
                    <button onclick="calculateClarkRule()" class="w-full bg-yellow-600 text-white py-2 rounded-md hover:bg-yellow-700 transition duration-200 font-semibold mt-2">
                        Calculate Clark's Dose
                    </button>
                    <div id="p-clark-result" class="mt-3 text-center p-2 rounded-md bg-white font-bold text-gray-900 hidden">
                        Clark's Approx. Dose: <span id="p-clark-output" class="text-lg text-yellow-700">0 mg</span>
                    </div>
                </section>

            </div>

            <!-- Adult Calculator Tab -->
            <div id="content-adult" class="tab-content hidden">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Adult Dosing</h2>
                
                <!-- Section 1: Dose to Volume Calculation (Standard Dilution) -->
                <section class="bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200">
                    <h3 class="font-bold text-lg mb-3 text-cyan-700">Dose to Volume (mL) Calculation</h3>
                    
                    <!-- Desired Dose Input -->
                    <div class="input-group">
                        <label for="a-desired-dose" class="block text-sm font-medium text-gray-700">Desired Dose (mg)</label>
                        <input type="number" id="a-desired-dose" min="0.1" step="0.1" placeholder="e.g., 50" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-cyan-500 focus:border-cyan-500 p-2.5">
                    </div>
                    
                    <!-- Concentration Input (mg/mL) -->
                    <div class="input-group">
                        <label for="a-concentration" class="block text-sm font-medium text-gray-700">Stock Concentration (mg/mL)</label>
                        <input type="number" id="a-concentration" min="0.1" step="0.1" placeholder="e.g., 25" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-cyan-500 focus:border-cyan-500 p-2.5">
                    </div>

                    <button onclick="calculateAdult()" class="w-full bg-cyan-600 text-white py-2 rounded-md hover:bg-cyan-700 transition duration-200 font-semibold mt-2">
                        Calculate Volume
                    </button>
                </section>

                <!-- Adult Results Section -->
                <div id="a-results" class="space-y-3 bg-cyan-50 p-4 rounded-xl hidden border-2 border-cyan-300">
                    <h3 class="text-xl font-bold text-cyan-800">Result</h3>
                    <div class="flex justify-between items-center py-2">
                        <span class="text-sm font-medium text-gray-600">Volume to Administer:</span>
                        <span id="a-output-volume" class="text-2xl font-extrabold text-cyan-600">0 mL</span>
                    </div>
                </div>

            </div>

             <!-- Error/Message Box -->
            <div id="message-box" class="fixed inset-x-0 bottom-0 mx-auto w-11/12 max-w-sm bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6 transition-transform transform translate-y-full opacity-0 duration-300" role="alert">
                <p id="message-text" class="font-semibold text-sm"></p>
            </div>
        </main>

    </div>

    <script>
        // Utility Functions
        const KG_PER_LBS = 2.20462;

        /**
         * Shows a temporary message box for alerts/errors instead of using the native alert().
         * @param {string} message - The message to display.
         */
        function showMessage(message) {
            const box = document.getElementById('message-box');
            const text = document.getElementById('message-text');
            text.textContent = message;

            // Show the box
            box.classList.remove('translate-y-full', 'opacity-0');
            box.classList.add('translate-y-0', 'opacity-100');

            // Hide the box after 4 seconds
            setTimeout(() => {
                box.classList.remove('translate-y-0', 'opacity-100');
                box.classList.add('translate-y-full', 'opacity-0');
            }, 4000);
        }

        /**
         * Switches the active calculator tab.
         * @param {string} tabName - 'pediatric' or 'adult'.
         */
        function showTab(tabName) {
            // Update buttons
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`tab-${tabName}`).classList.add('active');

            // Update content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
            document.getElementById(`content-${tabName}`).classList.remove('hidden');
            
            // Clear results when switching tabs
            document.getElementById('p-results').classList.add('hidden');
            document.getElementById('a-results').classList.add('hidden');
            document.getElementById('p-clark-result').classList.add('hidden');
        }

        /**
         * Calculates the standard pediatric dose (mg/kg to mL).
         */
        function calculatePediatric() {
            const weightInput = parseFloat(document.getElementById('p-weight').value);
            const unit = document.getElementById('p-weight-unit').value;
            const dosage = parseFloat(document.getElementById('p-dosage-mgkg').value);
            const concentration = parseFloat(document.getElementById('p-concentration').value);
            
            const resultsDiv = document.getElementById('p-results');
            resultsDiv.classList.add('hidden');

            if (!weightInput || !dosage || !concentration || weightInput <= 0 || dosage <= 0 || concentration <= 0) {
                showMessage("Please enter valid positive values for Weight, Dosage, and Concentration.");
                return;
            }

            // 1. Convert weight to KG if necessary
            const weightKg = unit === 'lbs' ? weightInput / KG_PER_LBS : weightInput;
            
            // 2. Calculate Total Dose (mg)
            const totalDoseMg = weightKg * dosage;
            
            // 3. Calculate Volume to Administer (mL)
            const volumeMl = totalDoseMg / concentration;

            // Display results, rounding to 2 decimal places for clinical utility
            document.getElementById('p-output-weight').textContent = `${weightKg.toFixed(2)} kg`;
            document.getElementById('p-output-dose').textContent = `${totalDoseMg.toFixed(2)} mg`;
            document.getElementById('p-output-volume').textContent = `${volumeMl.toFixed(2)} mL`;
            resultsDiv.classList.remove('hidden');
        }
        
        /**
         * Calculates Clark's Rule approximation.
         */
        function calculateClarkRule() {
            const weightLbs = parseFloat(document.getElementById('p-clark-weight-lbs').value);
            const adultDoseMg = parseFloat(document.getElementById('p-clark-adult-dose').value);
            
            const clarkResultDiv = document.getElementById('p-clark-result');
            clarkResultDiv.classList.add('hidden');
            
            if (!weightLbs || !adultDoseMg || weightLbs <= 0 || adultDoseMg <= 0) {
                showMessage("Please enter valid positive values for Weight (lbs) and Adult Dose for Clark's Rule.");
                return;
            }

            // Clark's Rule: (Weight in lbs / 150 lbs) * Adult Dose (mg)
            const pediatricDoseMg = (weightLbs / 150) * adultDoseMg;

            // Display results, rounding to 2 decimal places
            document.getElementById('p-clark-output').textContent = `${pediatricDoseMg.toFixed(2)} mg`;
            clarkResultDiv.classList.remove('hidden');
        }

        /**
         * Calculates the adult dose (mg to mL).
         */
        function calculateAdult() {
            const desiredDose = parseFloat(document.getElementById('a-desired-dose').value);
            const concentration = parseFloat(document.getElementById('a-concentration').value);
            
            const resultsDiv = document.getElementById('a-results');
            resultsDiv.classList.add('hidden');

            if (!desiredDose || !concentration || desiredDose <= 0 || concentration <= 0) {
                showMessage("Please enter valid positive values for Desired Dose and Stock Concentration.");
                return;
            }

            // Calculation: Volume (mL) = Desired Dose (mg) / Concentration (mg/mL)
            const volumeMl = desiredDose / concentration;

            // Display results, rounding to 2 decimal places
            document.getElementById('a-output-volume').textContent = `${volumeMl.toFixed(2)} mL`;
            resultsDiv.classList.remove('hidden');
        }

        // Initial setup
        window.onload = () => {
             // Set default tab on load
             showTab('pediatric');
        };

        // Attach calculation listeners (using inline onclick for simplicity, but attaching them here again for robustness)
        document.getElementById('p-weight').addEventListener('input', calculatePediatric);
        document.getElementById('p-weight-unit').addEventListener('change', calculatePediatric);
        document.getElementById('p-dosage-mgkg').addEventListener('input', calculatePediatric);
        document.getElementById('p-concentration').addEventListener('input', calculatePediatric);
        
        document.getElementById('p-clark-weight-lbs').addEventListener('input', calculateClarkRule);
        document.getElementById('p-clark-adult-dose').addEventListener('input', calculateClarkRule);

        document.getElementById('a-desired-dose').addEventListener('input', calculateAdult);
        document.getElementById('a-concentration').addEventListener('input', calculateAdult);
    </script>
</body>
</html>
